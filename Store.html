<html>
    <head>

        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">-->
        <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.0/css/bootstrap.min.css">-->    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>-->
        <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>    
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="topnav.css">
        <link rel="stylesheet" href="Store.css">
        <!--<link rel="stylesheet" href="CartStyle.css" media="screen" title="no title" charset="utf-8">-->
    </head>

    <script src="topnav.js"></script>
    
    <script>
        function init() {
            topnavLoader("Store");
        }
    </script>


    <script>
        function Product(img_url, title, description, price) {
           this.img_url = img_url;
           this.title = title;
           this.description = description;
           this.price = price;
        }

        function loadProducts() {
            // Send the form data to the PHP script using AJAX
            $.ajax({
                type: 'GET',
                url: 'loadProductsScript.php',
                //data: formData,
                success: function(response) {
                    // Handle the response from the server
                    products = JSON.parse(response);             
                    initProducts(products);             
                    // You can show a success message or perform other actions here
                },
                error: function(error) {
                    console.log('An error occurred: ' + error);
                }            
            });                   
        }

        function initProducts(products) {                                             

            let prodsCont = document.getElementById("productsContainer");
            let counter = 0;

            initMyCart();

            let curRow = document.createElement("div");
            curRow.classList.add("row");                       

            const PROD_IN_ROW = 3;
            
            products.forEach(product => {    
                
                console.log(product);

                let curCol = document.createElement("div");
                curCol.classList.add("col-3");

                let curCard = document.createElement("div");
                curCard.classList.add("card");
                curCard.style = "width: 18rem;";

                let curImg = document.createElement("img");
                curImg.setAttribute("src", product.ImageURL);

                let curCardBody = document.createElement("div");
                curCardBody.classList.add("card-body");

                let curCardTitle = document.createElement("h5");
                curCardTitle.innerText = product.Name;

                let curCardDesc = document.createElement("p");
                curCardDesc.innerText = product.Description;
                curCardDesc.classList.add("Description");

                let curCardPrice = document.createElement("p");
                curCardPrice.innerText = "" + product.Price + " NIS";

                let curCardBtn = document.createElement("a");
                curCardBtn.classList.add("btn");
                curCardBtn.classList.add("btn-primary");
                curCardBtn.innerText = "Add To Cart";
                curCardBtn.setAttribute("value", product.ID);
                curCardBtn.addEventListener('click', function() {
                    let myCartItems = document.getElementById("myCartItems");

                    console.log(this);
                    console.log(this.getAttribute("value"));

                    let itemTitle = document.createElement("h2");

                    itemTitle.innerText = "Test Item";

                    myCartItems.appendChild(itemTitle);                    
                });

                curCardBody.appendChild(curCardTitle);
                curCardBody.appendChild(curCardDesc);
                curCardBody.appendChild(curCardPrice);
                curCardBody.appendChild(curCardBtn);

                curCard.appendChild(curImg);
                curCard.appendChild(curCardBody);

                curCol.appendChild(curCard);

                curRow.appendChild(curCol);

                counter++;

                if(counter%PROD_IN_ROW == 0) {
                    let curColPad = document.createElement("div");
                    curColPad.classList.add("col-3");

                    curRow.appendChild(curColPad);

                    prodsCont.appendChild(curRow);
                    curRow = document.createElement("div");
                    curRow.classList.add("row"); 
                }
            });

            if(counter%PROD_IN_ROW != 0) {
                prodsCont.appendChild(curRow);    
            }            
        }

        function initMyCart() {
            let myCartContainer = document.getElementById("myCartContainer");
            //let myCartRow = document.createElement("div");
            //let myCartColPad = document.createElement("div");
            //let myCartColMain = document.createElement("div");
            let myCartHeader = document.createElement("h1");
            let myCartItems = document.createElement("div");

            let myCartDiv = document.createElement("div");
            myCartDiv.setAttribute("id", "myCartDiv");            

            myCartItems.setAttribute("id", "myCartItems");

            myCartHeader.innerText = "My Cart:";
            
            //myCartContainer.appendChild(myCartRow)
            //myCartColMain.appendChild(myCartHeader);
            //myCartColMain.appendChild(myCartItems);
            //myCartRow.appendChild(myCartColPad);
            //myCartRow.appendChild(myCartColMain);

            //myCartContainer.classList.add("container");
            //myCartRow.classList.add("row"); 
            //myCartColPad.classList.add("col-9"); 
            //myCartColMain.classList.add("col-3"); 

            myCartContainer.classList.add("MyCartContainer");

            myCartDiv.appendChild(myCartHeader);
            myCartDiv.appendChild(myCartItems);

            myCartContainer.appendChild(myCartDiv);
        }

        
    </script>
    
    <body>

        <script>            
            init();                        
        </script>

        <div id="storeContainer">
            
            <div class="container" id="myCartContainer">
                <!--
                <div class="shopping-cart">
                    <!- - Title - ->
                    <div class="title">
                      Shopping Bag
                    </div>
              
                    <!- - Product #1 - ->
                    <div class="item">
                      <div class="buttons">
                        <span class="delete-btn"></span>
                        <span class="like-btn"></span>
                      </div>
              
                      <div class="image">
                        <img src="item-1.png" alt="" />
                      </div>
              
                      <div class="description">
                        <span>Common Projects</span>
                        <span>Bball High</span>
                        <span>White</span>
                      </div>
              
                      <div class="quantity">
                        <button class="plus-btn" type="button" name="button">
                          <img src="plus.svg" alt="" />
                        </button>
                        <input type="text" name="name" value="1">
                        <button class="minus-btn" type="button" name="button">
                          <img src="minus.svg" alt="" />
                        </button>
                      </div>
              
                      <div class="total-price">$549</div>
                    </div>
              
                    <!- - Product #2 - ->
                    <div class="item">
                      <div class="buttons">
                        <span class="delete-btn"></span>
                        <span class="like-btn"></span>
                      </div>
              
                      <div class="image">
                        <img src="item-2.png" alt=""/>
                      </div>
              
                      <div class="description">
                        <span>Maison Margiela</span>
                        <span>Future Sneakers</span>
                        <span>White</span>
                      </div>
              
                      <div class="quantity">
                        <button class="plus-btn" type="button" name="button">
                          <img src="plus.svg" alt="" />
                        </button>
                        <input type="text" name="name" value="1">
                        <button class="minus-btn" type="button" name="button">
                          <img src="minus.svg" alt="" />
                        </button>
                      </div>
              
                      <div class="total-price">$870</div>
                    </div>
              
                    <!- - Product #3 - ->
                    <div class="item">
                      <div class="buttons">
                        <span class="delete-btn"></span>
                        <span class="like-btn"></span>
                      </div>
              
                      <div class="image">
                        <img src="item-3.png" alt="" />
                      </div>
              
                      <div class="description">
                        <span>Our Legacy</span>
                        <span>Brushed Scarf</span>
                        <span>Brown</span>
                      </div>
              
                      <div class="quantity">
                        <button class="plus-btn" type="button" name="button">
                          <img src="plus.svg" alt="" />
                        </button>
                        <input type="text" name="name" value="1">
                        <button class="minus-btn" type="button" name="button">
                          <img src="minus.svg" alt="" />
                        </button>
                      </div>
              
                      <div class="total-price">$349</div>
                    </div>
                  </div> 
                  -->               
            </div>
            <div class="container" id="productsContainer"></div>            
        </div>

        <script>
            loadProducts();
        </script>

<!--
<script type="text/javascript">
    $('.minus-btn').on('click', function(e) {
          e.preventDefault();
          var $this = $(this);
          var $input = $this.closest('div').find('input');
          var value = parseInt($input.val());

          if (value > 1) {
              value = value - 1;
          } else {
              value = 0;
          }

      $input.val(value);

      });

      $('.plus-btn').on('click', function(e) {
          e.preventDefault();
          var $this = $(this);
          var $input = $this.closest('div').find('input');
          var value = parseInt($input.val());

          if (value < 100) {
            value = value + 1;
          } else {
              value =100;
          }

          $input.val(value);
      });

    $('.like-btn').on('click', function() {
      $(this).toggleClass('is-active');
    });
  </script>
  -->

    </body>
</html>