<html>
    <head>

        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">-->
        <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.0/css/bootstrap.min.css">-->    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>-->
        <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>    
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="topnav.css">
        <link rel="stylesheet" href="Store.css">
    </head>

    <script src="topnav.js"></script>
    
    <script>
        function init() {
            topnavLoader("Store");
        }
    </script>


    <script>
        function Product(img_url, title, description, price) {
           this.img_url = img_url;
           this.title = title;
           this.description = description;
           this.price = price;
        }

        function loadProducts() {
            // Send the form data to the PHP script using AJAX
            $.ajax({
                type: 'GET',
                url: 'loadProductsScript.php',
                //data: formData,
                success: function(response) {
                    // Handle the response from the server
                    products = JSON.parse(response);             
                    initProducts(products);             
                    // You can show a success message or perform other actions here
                },
                error: function(error) {
                    console.log('An error occurred: ' + error);
                }            
            });                   
        }

        function initProducts(products) {                                             

            let prodsCont = document.getElementById("productsContainer");
            let counter = 0;

            let curRow = document.createElement("div");
            curRow.classList.add("row");                       

            const PROD_IN_ROW = 4;
            
            products.forEach(product => {    
                
                console.log(product);

                let curCol = document.createElement("div");
                curCol.classList.add("col-3");

                let curCard = document.createElement("div");
                curCard.classList.add("card");
                curCard.style = "width: 18rem;";

                let curImg = document.createElement("img");
                curImg.setAttribute("src", product.ImageURL);

                let curCardBody = document.createElement("div");
                curCardBody.classList.add("card-body");

                let curCardTitle = document.createElement("h5");
                curCardTitle.innerText = product.Name;

                let curCardDesc = document.createElement("p");
                curCardDesc.innerText = product.Description;
                curCardDesc.classList.add("Description");

                let curCardPrice = document.createElement("p");
                curCardPrice.innerText = "" + product.Price + " NIS";

                let curCardBtn = document.createElement("a");
                curCardBtn.classList.add("btn");
                curCardBtn.classList.add("btn-primary");
                curCardBtn.innerText = "Add To Cart";

                curCardBody.appendChild(curCardTitle);
                curCardBody.appendChild(curCardDesc);
                curCardBody.appendChild(curCardPrice);
                curCardBody.appendChild(curCardBtn);

                curCard.appendChild(curImg);
                curCard.appendChild(curCardBody);

                curCol.appendChild(curCard);

                curRow.appendChild(curCol);

                counter++;

                if(counter%PROD_IN_ROW == 0) {
                    prodsCont.appendChild(curRow);
                    curRow = document.createElement("div");
                    curRow.classList.add("row"); 
                }
            });

            if(counter%PROD_IN_ROW != 0) {
                prodsCont.appendChild(curRow);    
            }            
        }



        
    </script>
    
    <body>

        <script>            
            init();                        
        </script>
        <!--
        <div class="container">
            <div class="row">
                <div class="col-4"></div>
                <div class="col-4"><h1>Store Page</h1></div>                
                <div class="col-4"></div>
            </div>
            <div class="row">
                <div class="col-3">
                    <div class="card" style="width: 18rem;">
                        <img src="https://www.ecostore.co.il/wp-content/uploads/2021/03/שמפו-היפופיאה-300x300.jpg" class="card-img-top" alt="...">
                        <div class="card-body">
                          <h5 class="card-title">Shampoo</h5>
                          <p class="card-text">Solid shampoo hipopaya for dry to regular hair, eden soap.</p>
                          <p class="card-text">₪34.00</p>                          
                          <a href="#" class="btn btn-primary">Add To Cart</a>
                        </div>
                      </div>
                </div>
                <div class="col-3">
                    <div class="card" style="width: 18rem;">
                        <img src="..." class="card-img-top" alt="...">
                        <div class="card-body">
                          <h5 class="card-title">Card title</h5>
                          <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                          <a href="#" class="btn btn-primary">Go somewhere</a>
                        </div>
                      </div>
                </div>
                <div class="col-3">
                    <div class="card" style="width: 18rem;">
                        <img src="..." class="card-img-top" alt="...">
                        <div class="card-body">
                          <h5 class="card-title">Card title</h5>
                          <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                          <a href="#" class="btn btn-primary">Go somewhere</a>
                        </div>
                      </div>
                </div>
                <div class="col-3">
                    <div class="card" style="width: 18rem;">
                        <img src="..." class="card-img-top" alt="...">
                        <div class="card-body">
                          <h5 class="card-title">Card title</h5>
                          <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                          <a href="#" class="btn btn-primary">Go somewhere</a>
                        </div>
                      </div>
                </div>
            </div>
            
        </div> 
        -->

        <div class="container" id="productsContainer">

        </div>

        <script>
            loadProducts();
        </script>
    </body>
</html>